# SillyTavern 三张角色卡 Prompt 技术对比

## 一、房东模拟器的「隐藏内容」技术

### 1.1 think 思考块

Prompt 要求 AI 在正文前先输出一段思考，用 think 标签包裹：

```
思考内容需要使用<think> </think>包裹，正文紧跟在</think>后
要求：必须按照规定思考步数推进
```

思考步骤：
- 当前在什么情景中？时间、地点、人物位置？
- interactive_input 中传递了怎样的需求？
- 剧情应当怎样才能符合互动式小说的设定？

前端插件识别 think 标签后隐藏这部分内容。

作用：让 AI 先「想一遍」再写正文，减少 OOC。

### 1.2 emotion_antThinking 情绪预演

Prompt 要求 AI 每次写情绪前，先用 HTML 注释输出两个版本：

```
每一次在正文里的描述角色态度的描述内容之前，
你必须使用 <!-- emotion_antThinking: 模拟内容 --> 格式

第一类：你认为角色最应该出现的情绪
第二类：此场景下最克制符合人物性格的情绪

正文中必须使用模拟中的第二类——更克制符合人物性格的情绪
```

HTML 注释不会在前端显示，但 AI 会先生成两个版本再选择更克制的那个。

作用：防止角色情绪过于激动或夸张。

---

## 二、三张卡片对比

### 又看一集（祥子卡）

- 架构：多 System 消息 + 角色分离
- 角色定义：CharacterCard + Rule 覆盖机制
- 成长机制：阶段制（陌生→恋慕→不渝）
- 防 OOC：信息隔离协议 + 场景示例
- 特点：Rule 可以覆盖 CharacterCard 的基础设定

### 萝莉足控（第一张）

- 架构：多 System 消息 + 变量系统
- 角色定义：JSON 嵌套结构
- 成长机制：「侵蚀度」变量驱动
- 防 OOC：varthinking 变量追踪
- 特点：每次输出都要更新变量状态

### 房东模拟器（新卡）

- 架构：多 System 消息 + 状态追踪
- 角色定义：YAML 格式人设
- 成长机制：好感度数值系统
- 防 OOC：think 思考块 + 情绪预演
- 特点：UpdateVariable 代码实时更新数据库

---

## 三、房东模拟器的独特技术

### 3.1 实时变量系统

每次输出后，AI 必须生成一段变量更新代码：

```javascript
_.set('世界.具体时间[0]', '19:00', '19:05');
_.add('角色数据.租客1.好感度[0]', 2);
_.set('角色数据.租客1.心情[0]', '对夏奈的小动作感到有趣');
```

后端插件解析这段代码并更新数据库。

### 3.2 分阶段好感度行为

根据好感度数值自动切换行为模式：

```
好感度 (20) → 礼貌疏远
- 交流仅限于必要的问候
- 在公共区域会点头示意后迅速离开
- 大部分时间会待在自己的房间里
```

---

## 四、对 nuero-sama-saki 的启示

| 技术 | 是否适用 | 原因 |
|------|----------|------|
| think 思考块 | 不适用 | 桌宠需要快速响应，思考块会增加延迟 |
| 情绪预演 | 可借鉴 | 简化为一条「情绪要克制」的规则 |
| 变量更新代码 | 不适用 | 太复杂，桌宠不需要这么精细的状态追踪 |
| 分阶段好感度 | 已替代 | 我们用「记忆驱动」替代了阶段制 |

最值得借鉴的是情绪预演的思路：在 Prompt 里强调「情绪表现要克制」，而不是让 AI 每次都输出两个版本。

---

文档创建时间：2026-01-11
